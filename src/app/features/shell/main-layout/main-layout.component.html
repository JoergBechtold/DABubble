<app-workspace-menu-toggler 
  *ngIf="!logo.isMobile()" 
  [isOpen]="isWorkspaceMenuOpen" 
  (toggle)="onToggleWorkspaceMenu()">
</app-workspace-menu-toggler>

@if(userOnline){
<div class="userOnline" [class.hide]="messageHide">
  <p *ngIf="lastOnlineUserName; else noName">{{ lastOnlineUserName }} ist online</p>
  <ng-template #noName>User ist online</ng-template>
</div>
}

<!-- 
  WICHTIG: main-layout hat IMMER 3 Grid-Spalten
  Klassen steuern welche Spalten sichtbar sind
-->
<div class="main-layout" 
  [class.mobile]="logo.isMobile()" 
  [class.workspace-open]="isWorkspaceMenuOpen"
  [class.thread-open]="selectedThread !== null">

  <!-- ========================================
       WORKSPACE SIDEBAR - Grid-Area: workspace
       ======================================== -->
  <aside class="workspace-sidebar"
    [class.active]="currentView === 'workspace'">
    <!-- Mobile: nur anzeigen wenn aktiv -->
    <app-workspace-menu 
      *ngIf="(logo.isMobile() && logo.isWorkspaceView()) || !logo.isMobile()"
      (channelSelected)="onChannelSelected($event)"
      (directMessageSelected)="onDirectMessageSelected($event)">
    </app-workspace-menu>
  </aside>

  <!-- ========================================
       CHAT MAIN - Grid-Area: chat
       Chat nimmt immer verfÃ¼gbaren Platz (1fr)
       ======================================== -->
  <main class="chat-main" 
    [class.active]="currentView === 'chat'">
    <!-- Mobile: nur anzeigen wenn aktiv -->
    <app-chat-area 
      *ngIf="!logo.isMobile() || logo.isChatView()"
      [channelId]="selectedChannelId" 
      [userId]="selectedUserId" 
      [isDM]="chatType === 'dm'"
      (threadOpened)="onThreadOpened($event)">
    </app-chat-area>
  </main>

  <!-- ========================================
       THREAD SIDEBAR - Grid-Area: thread
       ======================================== -->
  <aside class="thread-sidebar"
    [class.active]="currentView === 'thread'">
    <!-- Mobile: nur anzeigen wenn aktiv -->
    <app-thread-panel 
      *ngIf="selectedThread && (!logo.isMobile() || logo.isThreadView())"
      [message]="selectedThread" 
      [currentChannelName]="currentChannelName"
      [selectedChannelId]="selectedChannelId" 
      [highlightMessageId]="highlightMessageId" 
      (backToChat)="onBackToChat()">
    </app-thread-panel>
  </aside>
</div>